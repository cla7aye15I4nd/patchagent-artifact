=================================================================
==240907==ERROR: AddressSanitizer: heap-use-after-free on address 0x5100000023c4 at pc 0x7fe4b87872cc bp 0x7fff84b90170 sp 0x7fff84b90168
READ of size 4 at 0x5100000023c4 thread T0
    #0 0x7fe4b87872cb in Q_IsTypeOn /root/src/bifs/unquantize.c:169:12
    #1 0x7fe4b878b8c3 in gf_bifs_dec_unquant_field /root/src/bifs/unquantize.c:398:7
    #2 0x7fe4b87551cb in gf_bifs_dec_sf_field /root/src/bifs/field_decode.c:84:7
    #3 0x7fe4b875ac9c in gf_bifs_dec_field /root/src/bifs/field_decode.c:518:7
    #4 0x7fe4b875bcb7 in gf_bifs_dec_node_mask /root/src/bifs/field_decode.c:671:8
    #5 0x7fe4b8758f03 in gf_bifs_dec_node /root/src/bifs/field_decode.c:919:7
    #6 0x7fe4b875a41b in BD_DecMFFieldVec /root/src/bifs/field_decode.c:433:24
    #7 0x7fe4b875b181 in gf_bifs_dec_field /root/src/bifs/field_decode.c:559:9
    #8 0x7fe4b875b7c1 in gf_bifs_dec_node_list /root/src/bifs/field_decode.c:619:7
    #9 0x7fe4b8758f3d in gf_bifs_dec_node /root/src/bifs/field_decode.c:921:7
    #10 0x7fe4b8763f3e in BM_ParseNodeInsert /root/src/bifs/memory_decoder.c:433:9
    #11 0x7fe4b876576b in BM_ParseInsert /root/src/bifs/memory_decoder.c:583:10
    #12 0x7fe4b8768ffc in BM_ParseCommand /root/src/bifs/memory_decoder.c:907:8
    #13 0x7fe4b876965f in gf_bifs_flush_command_list /root/src/bifs/memory_decoder.c:962:9
    #14 0x7fe4b876a0bb in gf_bifs_decode_command_list /root/src/bifs/memory_decoder.c:1042:3
    #15 0x7fe4b8d85c95 in gf_sm_load_run_isom /root/src/scene_manager/loader_isom.c:303:10
    #16 0x7fe4b8d2d0c2 in gf_sm_load_run /root/src/scene_manager/scene_manager.c:719:28
    #17 0x5577c2189f15 in dump_isom_scene /root/applications/mp4box/filedump.c:203:14
    #18 0x5577c2175a36 in mp4box_main /root/applications/mp4box/mp4box.c:6344:7
    #19 0x5577c217b471 in main /root/applications/mp4box/mp4box.c:6811:1
    #20 0x7fe4b7d7b1c9  (/lib/x86_64-linux-gnu/libc.so.6+0x2a1c9) (BuildId: 8f2af70b7deed50338b9186c7dd60cef3826e18f)
    #21 0x7fe4b7d7b28a in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2a28a) (BuildId: 8f2af70b7deed50338b9186c7dd60cef3826e18f)
    #22 0x5577c215ac84 in _start (/root/bin/gcc/MP4Box+0x48c84) (BuildId: d3f0af4515dae014c4c01717864b99640e1d00d1)

0x5100000023c4 is located 132 bytes inside of 192-byte region [0x510000002340,0x510000002400)
freed by thread T0 here:
    #0 0x7fe4ba00450a in free (/usr/lib/llvm-18/lib/clang/18/lib/linux/libclang_rt.asan-x86_64.so+0xf850a) (BuildId: 49743e1a9753906ada8c1ae30e03059f556dfa80)
    #1 0x7fe4b8252ea4 in gf_free /root/src/utils/alloc.c:165:2
    #2 0x7fe4b8385c78 in gf_node_free /root/src/scenegraph/base_scenegraph.c:1622:2
    #3 0x7fe4b83d1c6c in QuantizationParameter_Del /root/src/scenegraph/mpeg4_nodes.c:11981:2
    #4 0x7fe4b83cc50d in gf_sg_mpeg4_node_del /root/src/scenegraph/mpeg4_nodes.c:37743:3
    #5 0x7fe4b837f965 in gf_node_del /root/src/scenegraph/base_scenegraph.c:1904:59
    #6 0x7fe4b837b8e9 in gf_node_unregister /root/src/scenegraph/base_scenegraph.c:763:3
    #7 0x7fe4b8383d40 in gf_node_unregister_children /root/src/scenegraph/base_scenegraph.c:1371:3
    #8 0x7fe4b83d0d51 in LOD_Del /root/src/scenegraph/mpeg4_nodes.c:8552:2
    #9 0x7fe4b83cc3bd in gf_sg_mpeg4_node_del /root/src/scenegraph/mpeg4_nodes.c:37671:3
    #10 0x7fe4b837f965 in gf_node_del /root/src/scenegraph/base_scenegraph.c:1904:59
    #11 0x7fe4b837b8e9 in gf_node_unregister /root/src/scenegraph/base_scenegraph.c:763:3
    #12 0x7fe4b875902c in gf_bifs_dec_node /root/src/bifs/field_decode.c:931:3
    #13 0x7fe4b8763f3e in BM_ParseNodeInsert /root/src/bifs/memory_decoder.c:433:9
    #14 0x7fe4b876576b in BM_ParseInsert /root/src/bifs/memory_decoder.c:583:10
    #15 0x7fe4b8768ffc in BM_ParseCommand /root/src/bifs/memory_decoder.c:907:8
    #16 0x7fe4b876965f in gf_bifs_flush_command_list /root/src/bifs/memory_decoder.c:962:9
    #17 0x7fe4b876a0bb in gf_bifs_decode_command_list /root/src/bifs/memory_decoder.c:1042:3
    #18 0x7fe4b8d85c95 in gf_sm_load_run_isom /root/src/scene_manager/loader_isom.c:303:10
    #19 0x7fe4b8d2d0c2 in gf_sm_load_run /root/src/scene_manager/scene_manager.c:719:28
    #20 0x5577c2189f15 in dump_isom_scene /root/applications/mp4box/filedump.c:203:14
    #21 0x5577c2175a36 in mp4box_main /root/applications/mp4box/mp4box.c:6344:7
    #22 0x5577c217b471 in main /root/applications/mp4box/mp4box.c:6811:1
    #23 0x7fe4b7d7b1c9  (/lib/x86_64-linux-gnu/libc.so.6+0x2a1c9) (BuildId: 8f2af70b7deed50338b9186c7dd60cef3826e18f)
    #24 0x7fe4b7d7b28a in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2a28a) (BuildId: 8f2af70b7deed50338b9186c7dd60cef3826e18f)
    #25 0x5577c215ac84 in _start (/root/bin/gcc/MP4Box+0x48c84) (BuildId: d3f0af4515dae014c4c01717864b99640e1d00d1)

previously allocated by thread T0 here:
    #0 0x7fe4ba0047a3 in malloc (/usr/lib/llvm-18/lib/clang/18/lib/linux/libclang_rt.asan-x86_64.so+0xf87a3) (BuildId: 49743e1a9753906ada8c1ae30e03059f556dfa80)
    #1 0x7fe4b8252e24 in gf_malloc /root/src/utils/alloc.c:150:9
    #2 0x7fe4b83ac454 in QuantizationParameter_Create /root/src/scenegraph/mpeg4_nodes.c:12496:2
    #3 0x7fe4b83cad22 in gf_sg_mpeg4_node_new /root/src/scenegraph/mpeg4_nodes.c:36871:10
    #4 0x7fe4b8387fc9 in gf_node_new /root/src/scenegraph/base_scenegraph.c:1996:51
    #5 0x7fe4b8758d68 in gf_bifs_dec_node /root/src/bifs/field_decode.c:893:15
    #6 0x7fe4b875a41b in BD_DecMFFieldVec /root/src/bifs/field_decode.c:433:24
    #7 0x7fe4b875b181 in gf_bifs_dec_field /root/src/bifs/field_decode.c:559:9
    #8 0x7fe4b875b7c1 in gf_bifs_dec_node_list /root/src/bifs/field_decode.c:619:7
    #9 0x7fe4b8758f3d in gf_bifs_dec_node /root/src/bifs/field_decode.c:921:7
    #10 0x7fe4b8763f3e in BM_ParseNodeInsert /root/src/bifs/memory_decoder.c:433:9
    #11 0x7fe4b876576b in BM_ParseInsert /root/src/bifs/memory_decoder.c:583:10
    #12 0x7fe4b8768ffc in BM_ParseCommand /root/src/bifs/memory_decoder.c:907:8
    #13 0x7fe4b876965f in gf_bifs_flush_command_list /root/src/bifs/memory_decoder.c:962:9
    #14 0x7fe4b876a0bb in gf_bifs_decode_command_list /root/src/bifs/memory_decoder.c:1042:3
    #15 0x7fe4b8d85c95 in gf_sm_load_run_isom /root/src/scene_manager/loader_isom.c:303:10
    #16 0x7fe4b8d2d0c2 in gf_sm_load_run /root/src/scene_manager/scene_manager.c:719:28
    #17 0x5577c2189f15 in dump_isom_scene /root/applications/mp4box/filedump.c:203:14
    #18 0x5577c2175a36 in mp4box_main /root/applications/mp4box/mp4box.c:6344:7
    #19 0x5577c217b471 in main /root/applications/mp4box/mp4box.c:6811:1
    #20 0x7fe4b7d7b1c9  (/lib/x86_64-linux-gnu/libc.so.6+0x2a1c9) (BuildId: 8f2af70b7deed50338b9186c7dd60cef3826e18f)
    #21 0x7fe4b7d7b28a in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2a28a) (BuildId: 8f2af70b7deed50338b9186c7dd60cef3826e18f)
    #22 0x5577c215ac84 in _start (/root/bin/gcc/MP4Box+0x48c84) (BuildId: d3f0af4515dae014c4c01717864b99640e1d00d1)

SUMMARY: AddressSanitizer: heap-use-after-free /root/src/bifs/unquantize.c:169:12 in Q_IsTypeOn
Shadow bytes around the buggy address:
  0x510000002100: fa fa fa fa fa fa fa fa fd fd fd fd fd fd fd fd
  0x510000002180: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fa
  0x510000002200: fa fa fa fa fa fa fa fa fd fd fd fd fd fd fd fd
  0x510000002280: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fa
  0x510000002300: fa fa fa fa fa fa fa fa fd fd fd fd fd fd fd fd
=>0x510000002380: fd fd fd fd fd fd fd fd[fd]fd fd fd fd fd fd fd
  0x510000002400: fa fa fa fa fa fa fa fa fd fd fd fd fd fd fd fd
  0x510000002480: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x510000002500: fa fa fa fa fa fa fa fa fd fd fd fd fd fd fd fd
  0x510000002580: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x510000002600: fa fa fa fa fa fa fa fa fd fd fd fd fd fd fd fd
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==240907==ABORTING
