=================================================================
==162572==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x7f3830f7eec0 at pc 0x7f3832e4f9fa bp 0x7fffc2a470d0 sp 0x7fffc2a470c8
WRITE of size 4 at 0x7f3830f7eec0 thread T0
    #0 0x7f3832e4f9f9 in gf_hevc_read_pps_bs_internal /root/src/media_tools/av_parsers.c:8510:24
    #1 0x7f3832e506e6 in gf_hevc_parse_nalu_bs /root/src/media_tools/av_parsers.c:8635:30
    #2 0x7f38339a933f in naludmx_parse_nal_hevc /root/src/filters/reframe_nalu.c:2164:8
    #3 0x7f383399f6b7 in naludmx_process /root/src/filters/reframe_nalu.c:3059:23
    #4 0x7f38334fc5b0 in gf_filter_process_task /root/src/filter_core/filter.c:2582:7
    #5 0x7f38334ced28 in gf_fs_thread_proc /root/src/filter_core/filter_session.c:1799:3
    #6 0x7f38334cb300 in gf_fs_run /root/src/filter_core/filter_session.c:2043:2
    #7 0x7f3832ea6b13 in gf_media_import /root/src/media_tools/media_import.c:1225:3
    #8 0x560741f248eb in convert_file_info /root/applications/mp4box/fileimport.c:128:6
    #9 0x560741ee2f15 in mp4boxMain /root/applications/mp4box/main.c:6052:6
    #10 0x560741ee89f1 in main /root/applications/mp4box/main.c:6585:1
    #11 0x7f38320a21c9  (/lib/x86_64-linux-gnu/libc.so.6+0x2a1c9) (BuildId: 8f2af70b7deed50338b9186c7dd60cef3826e18f)
    #12 0x7f38320a228a in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2a28a) (BuildId: 8f2af70b7deed50338b9186c7dd60cef3826e18f)
    #13 0x560741ec8c84 in _start (/root/bin/gcc/MP4Box+0x47c84) (BuildId: b96a4a3d41b60ee62ea9dd9367c4dde76cb9df16)

0x7f3830f7eec0 is located 0 bytes after 157376-byte region [0x7f3830f58800,0x7f3830f7eec0)
allocated by thread T0 here:
    #0 0x7f38342e17a3 in malloc (/usr/lib/llvm-18/lib/clang/18/lib/linux/libclang_rt.asan-x86_64.so+0xf87a3) (BuildId: 49743e1a9753906ada8c1ae30e03059f556dfa80)
    #1 0x7f3832572de4 in gf_malloc /root/src/utils/alloc.c:150:9
    #2 0x7f3833992375 in naludmx_configure_pid /root/src/filters/reframe_nalu.c:348:25
    #3 0x7f3833458d6a in gf_filter_pid_configure /root/src/filter_core/filter_pid.c:758:6
    #4 0x7f3833472f57 in gf_filter_pid_connect_task /root/src/filter_core/filter_pid.c:1068:3
    #5 0x7f38334ced28 in gf_fs_thread_proc /root/src/filter_core/filter_session.c:1799:3
    #6 0x7f38334cb300 in gf_fs_run /root/src/filter_core/filter_session.c:2043:2
    #7 0x7f3832ea6b13 in gf_media_import /root/src/media_tools/media_import.c:1225:3
    #8 0x560741f248eb in convert_file_info /root/applications/mp4box/fileimport.c:128:6
    #9 0x560741ee2f15 in mp4boxMain /root/applications/mp4box/main.c:6052:6
    #10 0x560741ee89f1 in main /root/applications/mp4box/main.c:6585:1
    #11 0x7f38320a21c9  (/lib/x86_64-linux-gnu/libc.so.6+0x2a1c9) (BuildId: 8f2af70b7deed50338b9186c7dd60cef3826e18f)
    #12 0x7f38320a228a in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2a28a) (BuildId: 8f2af70b7deed50338b9186c7dd60cef3826e18f)
    #13 0x560741ec8c84 in _start (/root/bin/gcc/MP4Box+0x47c84) (BuildId: b96a4a3d41b60ee62ea9dd9367c4dde76cb9df16)

SUMMARY: AddressSanitizer: heap-buffer-overflow /root/src/media_tools/av_parsers.c:8510:24 in gf_hevc_read_pps_bs_internal
Shadow bytes around the buggy address:
  0x7f3830f7ec00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x7f3830f7ec80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x7f3830f7ed00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x7f3830f7ed80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x7f3830f7ee00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=>0x7f3830f7ee80: 00 00 00 00 00 00 00 00[fa]fa fa fa fa fa fa fa
  0x7f3830f7ef00: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x7f3830f7ef80: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x7f3830f7f000: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x7f3830f7f080: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x7f3830f7f100: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==162572==ABORTING
