=================================================================
==624973==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x502000002380 at pc 0x55bc84653e51 bp 0x7ffd29bc7c90 sp 0x7ffd29bc7c88
READ of size 4 at 0x502000002380 thread T0
    #0 0x55bc84653e50 in mrb_vm_exec /root/src/vm.c:1120:23
    #1 0x55bc84652e25 in mrb_vm_run /root/src/vm.c:1032:12
    #2 0x55bc8464fdd3 in mrb_top_run /root/src/vm.c:2969:12
    #3 0x55bc846cc462 in mrb_load_exec /root/mrbgems/mruby-compiler/core/parse.y:6896:7
    #4 0x55bc846ccc3c in mrb_load_detect_file_cxt /root/mrbgems/mruby-compiler/core/parse.y:6939:12
    #5 0x55bc845c7850 in main /root/mrbgems/mruby-bin-mruby/tools/mruby/mruby.c:347:11
    #6 0x7fdac188c1c9  (/lib/x86_64-linux-gnu/libc.so.6+0x2a1c9) (BuildId: 8f2af70b7deed50338b9186c7dd60cef3826e18f)
    #7 0x7fdac188c28a in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2a28a) (BuildId: 8f2af70b7deed50338b9186c7dd60cef3826e18f)
    #8 0x55bc845c5a34 in _start (/root/bin/mruby+0x94a34) (BuildId: 5fe2360dac4cfa02f147b72d86b6f33aad43d5fe)

0x502000002380 is located 0 bytes after 16-byte region [0x502000002370,0x502000002380)
allocated by thread T0 here:
    #0 0x7fdac1f07bc0 in realloc (/usr/lib/llvm-18/lib/clang/18/lib/linux/libclang_rt.asan-x86_64.so+0xf8bc0) (BuildId: 49743e1a9753906ada8c1ae30e03059f556dfa80)
    #1 0x55bc846235f5 in mrb_default_allocf /root/src/state.c:68:12
    #2 0x55bc845f4f8e in mrb_realloc_simple /root/src/gc.c:226:8
    #3 0x55bc8473ce29 in codegen_realloc /root/mrbgems/mruby-compiler/core/codegen.c:164:7
    #4 0x55bc8474b627 in scope_finish /root/mrbgems/mruby-compiler/core/codegen.c:3609:39
    #5 0x55bc84742196 in scope_body /root/mrbgems/mruby-compiler/core/codegen.c:1462:3
    #6 0x55bc84730ea2 in codegen /root/mrbgems/mruby-compiler/core/codegen.c:2346:5
    #7 0x55bc8472b64d in generate_code /root/mrbgems/mruby-compiler/core/codegen.c:3751:5
    #8 0x55bc8472b1a1 in mrb_generate_code /root/mrbgems/mruby-compiler/core/codegen.c:3774:10
    #9 0x55bc846cbdc1 in mrb_load_exec /root/mrbgems/mruby-compiler/core/parse.y:6871:10
    #10 0x55bc846ccc3c in mrb_load_detect_file_cxt /root/mrbgems/mruby-compiler/core/parse.y:6939:12
    #11 0x55bc845c7850 in main /root/mrbgems/mruby-bin-mruby/tools/mruby/mruby.c:347:11
    #12 0x7fdac188c1c9  (/lib/x86_64-linux-gnu/libc.so.6+0x2a1c9) (BuildId: 8f2af70b7deed50338b9186c7dd60cef3826e18f)
    #13 0x7fdac188c28a in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2a28a) (BuildId: 8f2af70b7deed50338b9186c7dd60cef3826e18f)
    #14 0x55bc845c5a34 in _start (/root/bin/mruby+0x94a34) (BuildId: 5fe2360dac4cfa02f147b72d86b6f33aad43d5fe)

SUMMARY: AddressSanitizer: heap-buffer-overflow /root/src/vm.c:1120:23 in mrb_vm_exec
Shadow bytes around the buggy address:
  0x502000002100: fa fa fd fd fa fa fd fd fa fa fd fd fa fa 00 00
  0x502000002180: fa fa 00 00 fa fa 00 00 fa fa 00 00 fa fa 00 00
  0x502000002200: fa fa fd fd fa fa 00 00 fa fa fd fd fa fa 00 fa
  0x502000002280: fa fa 00 fa fa fa 06 fa fa fa fd fd fa fa 07 fa
  0x502000002300: fa fa fd fd fa fa fd fd fa fa 00 00 fa fa 00 00
=>0x502000002380:[fa]fa 00 fa fa fa 00 fa fa fa 02 fa fa fa fa fa
  0x502000002400: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x502000002480: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x502000002500: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x502000002580: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x502000002600: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==624973==ABORTING
