=================================================================
==623319==ERROR: AddressSanitizer: heap-use-after-free on address 0x503000005aa0 at pc 0x562472b08ea9 bp 0x7ffce0ddf990 sp 0x7ffce0ddf988
READ of size 1 at 0x503000005aa0 thread T0
    #0 0x562472b08ea8 in str_escape /root/src/string.c:1239:9
    #1 0x562472b0a431 in mrb_str_inspect /root/src/string.c:2659:10
    #2 0x562472b3a763 in mrb_vm_exec /root/src/vm.c:1638:18
    #3 0x562472b2dde5 in mrb_vm_run /root/src/vm.c:1132:12
    #4 0x562472b2a7d3 in mrb_top_run /root/src/vm.c:3045:12
    #5 0x562472ba7ea2 in mrb_load_exec /root/mrbgems/mruby-compiler/core/parse.y:6891:7
    #6 0x562472ba867c in mrb_load_detect_file_cxt /root/mrbgems/mruby-compiler/core/parse.y:6934:12
    #7 0x562472aa98c3 in main /root/mrbgems/mruby-bin-mruby/tools/mruby/mruby.c:357:11
    #8 0x7f2530c871c9  (/lib/x86_64-linux-gnu/libc.so.6+0x2a1c9) (BuildId: 8f2af70b7deed50338b9186c7dd60cef3826e18f)
    #9 0x7f2530c8728a in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2a28a) (BuildId: 8f2af70b7deed50338b9186c7dd60cef3826e18f)
    #10 0x562472aa7a54 in _start (/root/bin/mruby+0x9aa54) (BuildId: 71ea1dad0d2b14df1937e33041073877587bbee1)

0x503000005aa0 is located 0 bytes inside of 29-byte region [0x503000005aa0,0x503000005abd)
freed by thread T0 here:
    #0 0x7f253130250a in free (/usr/lib/llvm-18/lib/clang/18/lib/linux/libclang_rt.asan-x86_64.so+0xf850a) (BuildId: 49743e1a9753906ada8c1ae30e03059f556dfa80)
    #1 0x562472afdb6b in mrb_default_allocf /root/src/state.c:65:5
    #2 0x562472ad7e7d in mrb_free /root/src/gc.c:289:3
    #3 0x562472aff835 in mrb_gc_free_str /root/src/string.c:237:5
    #4 0x562472adc8a6 in obj_free /root/src/gc.c:863:5
    #5 0x562472ade111 in incremental_sweep_phase /root/src/gc.c:1143:11
    #6 0x562472adcdd9 in incremental_gc /root/src/gc.c:1209:20
    #7 0x562472ada706 in incremental_gc_until /root/src/gc.c:1225:5
    #8 0x562472ad9cc3 in mrb_incremental_gc /root/src/gc.c:1276:5
    #9 0x562472ad81db in mrb_obj_alloc /root/src/gc.c:570:5
    #10 0x562472b84e28 in break_new /root/src/vm.c:925:9
    #11 0x562472b4637f in mrb_vm_exec /root/src/vm.c:2273:41
    #12 0x562472b2dde5 in mrb_vm_run /root/src/vm.c:1132:12
    #13 0x562472b297d6 in mrb_run /root/src/vm.c:3032:10
    #14 0x562472b2cf67 in mrb_yield_with_class /root/src/vm.c:880:11
    #15 0x562472acc30d in mrb_class_initialize /root/src/class.c:2000:5
    #16 0x562472b3a763 in mrb_vm_exec /root/src/vm.c:1638:18
    #17 0x562472b2dde5 in mrb_vm_run /root/src/vm.c:1132:12
    #18 0x562472b2a7d3 in mrb_top_run /root/src/vm.c:3045:12
    #19 0x562472ba7ea2 in mrb_load_exec /root/mrbgems/mruby-compiler/core/parse.y:6891:7
    #20 0x562472ba867c in mrb_load_detect_file_cxt /root/mrbgems/mruby-compiler/core/parse.y:6934:12
    #21 0x562472aa98c3 in main /root/mrbgems/mruby-bin-mruby/tools/mruby/mruby.c:357:11
    #22 0x7f2530c871c9  (/lib/x86_64-linux-gnu/libc.so.6+0x2a1c9) (BuildId: 8f2af70b7deed50338b9186c7dd60cef3826e18f)
    #23 0x7f2530c8728a in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2a28a) (BuildId: 8f2af70b7deed50338b9186c7dd60cef3826e18f)
    #24 0x562472aa7a54 in _start (/root/bin/mruby+0x9aa54) (BuildId: 71ea1dad0d2b14df1937e33041073877587bbee1)

previously allocated by thread T0 here:
    #0 0x7f2531302bc0 in realloc (/usr/lib/llvm-18/lib/clang/18/lib/linux/libclang_rt.asan-x86_64.so+0xf8bc0) (BuildId: 49743e1a9753906ada8c1ae30e03059f556dfa80)
    #1 0x562472afdb85 in mrb_default_allocf /root/src/state.c:69:12
    #2 0x562472ad765e in mrb_realloc_simple /root/src/gc.c:227:8
    #3 0x562472ad7be4 in mrb_realloc /root/src/gc.c:241:8
    #4 0x562472ad7d10 in mrb_malloc /root/src/gc.c:257:10
    #5 0x562472aff14f in str_init_normal_capa /root/src/string.c:35:23
    #6 0x562472b158d0 in str_init_normal /root/src/string.c:48:10
    #7 0x562472aff496 in str_new /root/src/string.c:127:10
    #8 0x562472b0b254 in mrb_str_times /root/src/string.c:897:10
    #9 0x562472b3a763 in mrb_vm_exec /root/src/vm.c:1638:18
    #10 0x562472b2dde5 in mrb_vm_run /root/src/vm.c:1132:12
    #11 0x562472b297d6 in mrb_run /root/src/vm.c:3032:10
    #12 0x562472b2cf67 in mrb_yield_with_class /root/src/vm.c:880:11
    #13 0x562472acc30d in mrb_class_initialize /root/src/class.c:2000:5
    #14 0x562472b3a763 in mrb_vm_exec /root/src/vm.c:1638:18
    #15 0x562472b2dde5 in mrb_vm_run /root/src/vm.c:1132:12
    #16 0x562472b2a7d3 in mrb_top_run /root/src/vm.c:3045:12
    #17 0x562472ba7ea2 in mrb_load_exec /root/mrbgems/mruby-compiler/core/parse.y:6891:7
    #18 0x562472ba867c in mrb_load_detect_file_cxt /root/mrbgems/mruby-compiler/core/parse.y:6934:12
    #19 0x562472aa98c3 in main /root/mrbgems/mruby-bin-mruby/tools/mruby/mruby.c:357:11
    #20 0x7f2530c871c9  (/lib/x86_64-linux-gnu/libc.so.6+0x2a1c9) (BuildId: 8f2af70b7deed50338b9186c7dd60cef3826e18f)
    #21 0x7f2530c8728a in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2a28a) (BuildId: 8f2af70b7deed50338b9186c7dd60cef3826e18f)
    #22 0x562472aa7a54 in _start (/root/bin/mruby+0x9aa54) (BuildId: 71ea1dad0d2b14df1937e33041073877587bbee1)

SUMMARY: AddressSanitizer: heap-use-after-free /root/src/string.c:1239:9 in str_escape
Shadow bytes around the buggy address:
  0x503000005800: 00 00 00 05 fa fa fd fd fd fa fa fa 00 00 00 05
  0x503000005880: fa fa fd fd fd fa fa fa 00 00 00 05 fa fa fd fd
  0x503000005900: fd fa fa fa 00 00 00 05 fa fa fd fd fd fa fa fa
  0x503000005980: 00 00 00 05 fa fa fd fd fd fa fa fa 00 00 00 05
  0x503000005a00: fa fa fd fd fd fa fa fa 00 00 00 05 fa fa fd fd
=>0x503000005a80: fd fa fa fa[fd]fd fd fd fa fa fd fd fd fa fa fa
  0x503000005b00: 00 00 00 05 fa fa 00 00 00 fa fa fa 00 00 00 05
  0x503000005b80: fa fa 00 00 00 fa fa fa 00 00 00 05 fa fa 00 00
  0x503000005c00: 00 fa fa fa 00 00 00 fa fa fa fd fd fd fd fa fa
  0x503000005c80: 00 00 00 00 fa fa fa fa fa fa fa fa fa fa fa fa
  0x503000005d00: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==623319==ABORTING
