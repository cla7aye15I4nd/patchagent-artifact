=================================================================
==360105==ERROR: AddressSanitizer: heap-use-after-free on address 0x5020001e0890 at pc 0x7f3ffa787628 bp 0x7ffcac2a8bb0 sp 0x7ffcac2a8ba8
READ of size 1 at 0x5020001e0890 thread T0
    #0 0x7f3ffa787627 in r_reg_get_name_idx /root/libr/reg/reg.c:101:6
    #1 0x7f3ffa7894a4 in r_reg_get /root/libr/reg/reg.c:321:15
    #2 0x7f3ffa7892d4 in r_reg_setv /root/libr/reg/reg.c:301:17
    #3 0x7f3ffd2bf41d in r_core_anal_esil /root/libr/core/canal.c:5377:3
    #4 0x7f3ffd0df431 in cmd_anal_all /root/libr/core/./cmd_anal.c:11056:5
    #5 0x7f3ffd024185 in cmd_anal /root/libr/core/./cmd_anal.c:11966:8
    #6 0x7f3ffd2952f9 in r_cmd_call /root/libr/core/cmd_api.c:537:10
    #7 0x7f3ffd091cb1 in r_core_cmd_subst_i /root/libr/core/cmd.c:4478:8
    #8 0x7f3ffd08749f in r_core_cmd_subst /root/libr/core/cmd.c:3364:9
    #9 0x7f3ffd00a698 in run_cmd_depth /root/libr/core/cmd.c:5366:9
    #10 0x7f3ffcffd759 in r_core_cmd /root/libr/core/cmd.c:5449:8
    #11 0x7f3ffcfca4be in r_core_cmd0 /root/libr/core/cmd.c:5606:9
    #12 0x7f3ffd0dded4 in cmd_anal_all /root/libr/core/./cmd_anal.c:10921:7
    #13 0x7f3ffd024185 in cmd_anal /root/libr/core/./cmd_anal.c:11966:8
    #14 0x7f3ffd2952f9 in r_cmd_call /root/libr/core/cmd_api.c:537:10
    #15 0x7f3ffd091cb1 in r_core_cmd_subst_i /root/libr/core/cmd.c:4478:8
    #16 0x7f3ffd08749f in r_core_cmd_subst /root/libr/core/cmd.c:3364:9
    #17 0x7f3ffd00a698 in run_cmd_depth /root/libr/core/cmd.c:5366:9
    #18 0x7f3ffcffd759 in r_core_cmd /root/libr/core/cmd.c:5449:8
    #19 0x7f3ffcfca4be in r_core_cmd0 /root/libr/core/cmd.c:5606:9
    #20 0x7f3ffa5b483e in r_main_radare2 /root/libr/main/radare2.c:1393:11
    #21 0x55dbf599167e in main /root/binr/radare2/radare2.c:96:9
    #22 0x7f3ffa37d1c9  (/lib/x86_64-linux-gnu/libc.so.6+0x2a1c9) (BuildId: 8f2af70b7deed50338b9186c7dd60cef3826e18f)
    #23 0x7f3ffa37d28a in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2a28a) (BuildId: 8f2af70b7deed50338b9186c7dd60cef3826e18f)
    #24 0x55dbf59901e4 in _start (/root/bin/radare2+0x21e4) (BuildId: e5609c0e95ccbabcbd98b96765504fa96a9a28c4)

0x5020001e0890 is located 0 bytes inside of 3-byte region [0x5020001e0890,0x5020001e0893)
freed by thread T0 here:
    #0 0x7f3fffd7650a in free (/usr/lib/llvm-18/lib/clang/18/lib/linux/libclang_rt.asan-x86_64.so+0xf850a) (BuildId: 49743e1a9753906ada8c1ae30e03059f556dfa80)
    #1 0x7f3ffa7880da in r_reg_free_internal /root/libr/reg/reg.c:178:4
    #2 0x7f3ffa796b6d in r_reg_set_profile_string /root/libr/reg/profile.c:150:2
    #3 0x7f3ffb839331 in r_anal_set_reg_profile /root/libr/anal/anal.c:258:4
    #4 0x7f3ffb8385e3 in r_anal_set_bits /root/libr/anal/anal.c:324:4
    #5 0x7f3ffd1c5db2 in cb_asmbits /root/libr/core/cconfig.c:884:8
    #6 0x7f3fffaf779e in r_config_set_i /root/libr/config/config.c:574:13
    #7 0x7f3ffd20c816 in r_core_seek_arch_bits /root/libr/core/cio.c:377:3
    #8 0x7f3ffd2beb22 in r_core_anal_esil /root/libr/core/canal.c:5293:3
    #9 0x7f3ffd0df431 in cmd_anal_all /root/libr/core/./cmd_anal.c:11056:5
    #10 0x7f3ffd024185 in cmd_anal /root/libr/core/./cmd_anal.c:11966:8
    #11 0x7f3ffd2952f9 in r_cmd_call /root/libr/core/cmd_api.c:537:10
    #12 0x7f3ffd091cb1 in r_core_cmd_subst_i /root/libr/core/cmd.c:4478:8
    #13 0x7f3ffd08749f in r_core_cmd_subst /root/libr/core/cmd.c:3364:9
    #14 0x7f3ffd00a698 in run_cmd_depth /root/libr/core/cmd.c:5366:9
    #15 0x7f3ffcffd759 in r_core_cmd /root/libr/core/cmd.c:5449:8
    #16 0x7f3ffcfca4be in r_core_cmd0 /root/libr/core/cmd.c:5606:9
    #17 0x7f3ffd0dded4 in cmd_anal_all /root/libr/core/./cmd_anal.c:10921:7
    #18 0x7f3ffd024185 in cmd_anal /root/libr/core/./cmd_anal.c:11966:8
    #19 0x7f3ffd2952f9 in r_cmd_call /root/libr/core/cmd_api.c:537:10
    #20 0x7f3ffd091cb1 in r_core_cmd_subst_i /root/libr/core/cmd.c:4478:8
    #21 0x7f3ffd08749f in r_core_cmd_subst /root/libr/core/cmd.c:3364:9
    #22 0x7f3ffd00a698 in run_cmd_depth /root/libr/core/cmd.c:5366:9
    #23 0x7f3ffcffd759 in r_core_cmd /root/libr/core/cmd.c:5449:8
    #24 0x7f3ffcfca4be in r_core_cmd0 /root/libr/core/cmd.c:5606:9
    #25 0x7f3ffa5b483e in r_main_radare2 /root/libr/main/radare2.c:1393:11
    #26 0x55dbf599167e in main /root/binr/radare2/radare2.c:96:9
    #27 0x7f3ffa37d1c9  (/lib/x86_64-linux-gnu/libc.so.6+0x2a1c9) (BuildId: 8f2af70b7deed50338b9186c7dd60cef3826e18f)
    #28 0x7f3ffa37d28a in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2a28a) (BuildId: 8f2af70b7deed50338b9186c7dd60cef3826e18f)
    #29 0x55dbf59901e4 in _start (/root/bin/radare2+0x21e4) (BuildId: e5609c0e95ccbabcbd98b96765504fa96a9a28c4)

previously allocated by thread T0 here:
    #0 0x7f3fffd5e4de in strdup (/usr/lib/llvm-18/lib/clang/18/lib/linux/libclang_rt.asan-x86_64.so+0xe04de) (BuildId: 49743e1a9753906ada8c1ae30e03059f556dfa80)
    #1 0x7f3fff61cf6f in r_str_new /root/libr/util/str.c:688:14
    #2 0x7f3fff61e3f8 in r_str_dup /root/libr/util/str.c:865:14
    #3 0x7f3ffa787df2 in r_reg_set_name /root/libr/reg/reg.c:138:21
    #4 0x7f3ffa797b18 in parse_alias /root/libr/reg/profile.c:10:10
    #5 0x7f3ffa7975a7 in r_reg_set_profile_string /root/libr/reg/profile.c:220:8
    #6 0x7f3ffb839331 in r_anal_set_reg_profile /root/libr/anal/anal.c:258:4
    #7 0x7f3ffb8385e3 in r_anal_set_bits /root/libr/anal/anal.c:324:4
    #8 0x7f3ffd1c5db2 in cb_asmbits /root/libr/core/cconfig.c:884:8
    #9 0x7f3fffaf779e in r_config_set_i /root/libr/config/config.c:574:13
    #10 0x7f3ffd20c816 in r_core_seek_arch_bits /root/libr/core/cio.c:377:3
    #11 0x7f3ffd2beb22 in r_core_anal_esil /root/libr/core/canal.c:5293:3
    #12 0x7f3ffd0df431 in cmd_anal_all /root/libr/core/./cmd_anal.c:11056:5
    #13 0x7f3ffd024185 in cmd_anal /root/libr/core/./cmd_anal.c:11966:8
    #14 0x7f3ffd2952f9 in r_cmd_call /root/libr/core/cmd_api.c:537:10
    #15 0x7f3ffd091cb1 in r_core_cmd_subst_i /root/libr/core/cmd.c:4478:8
    #16 0x7f3ffd08749f in r_core_cmd_subst /root/libr/core/cmd.c:3364:9
    #17 0x7f3ffd00a698 in run_cmd_depth /root/libr/core/cmd.c:5366:9
    #18 0x7f3ffcffd759 in r_core_cmd /root/libr/core/cmd.c:5449:8
    #19 0x7f3ffcfca4be in r_core_cmd0 /root/libr/core/cmd.c:5606:9
    #20 0x7f3ffd0dded4 in cmd_anal_all /root/libr/core/./cmd_anal.c:10921:7
    #21 0x7f3ffd024185 in cmd_anal /root/libr/core/./cmd_anal.c:11966:8
    #22 0x7f3ffd2952f9 in r_cmd_call /root/libr/core/cmd_api.c:537:10
    #23 0x7f3ffd091cb1 in r_core_cmd_subst_i /root/libr/core/cmd.c:4478:8
    #24 0x7f3ffd08749f in r_core_cmd_subst /root/libr/core/cmd.c:3364:9
    #25 0x7f3ffd00a698 in run_cmd_depth /root/libr/core/cmd.c:5366:9
    #26 0x7f3ffcffd759 in r_core_cmd /root/libr/core/cmd.c:5449:8
    #27 0x7f3ffcfca4be in r_core_cmd0 /root/libr/core/cmd.c:5606:9
    #28 0x7f3ffa5b483e in r_main_radare2 /root/libr/main/radare2.c:1393:11
    #29 0x55dbf599167e in main /root/binr/radare2/radare2.c:96:9

SUMMARY: AddressSanitizer: heap-use-after-free /root/libr/reg/reg.c:101:6 in r_reg_get_name_idx
Shadow bytes around the buggy address:
  0x5020001e0600: fa fa fd fa fa fa fd fa fa fa fd fa fa fa fd fa
  0x5020001e0680: fa fa fd fa fa fa fd fa fa fa fd fa fa fa fd fa
  0x5020001e0700: fa fa fd fa fa fa fd fa fa fa fd fa fa fa fd fa
  0x5020001e0780: fa fa fd fa fa fa fd fa fa fa fd fa fa fa fd fa
  0x5020001e0800: fa fa fd fa fa fa fd fa fa fa fd fa fa fa fd fa
=>0x5020001e0880: fa fa[fd]fa fa fa fd fa fa fa fd fa fa fa fd fa
  0x5020001e0900: fa fa fd fa fa fa fd fa fa fa fd fa fa fa fd fa
  0x5020001e0980: fa fa fd fa fa fa fd fa fa fa fd fa fa fa fd fa
  0x5020001e0a00: fa fa fd fa fa fa fd fa fa fa fd fa fa fa fd fa
  0x5020001e0a80: fa fa fd fa fa fa fd fa fa fa fd fa fa fa fd fa
  0x5020001e0b00: fa fa fd fa fa fa fd fa fa fa fd fa fa fa fd fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==360105==ABORTING
